<UserControl x:Class="sol_denka_stockmanagement.Views.Controls.MasterManagementScreenControl.EditRegistration"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:local="clr-namespace:sol_denka_stockmanagement.Views.Controls.MasterManagementScreenControl"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d"
             Background="White"
             d:DesignHeight="450"
             d:DesignWidth="640">

    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisibility"/>
    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="60"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- ===== ヘッダー ===== -->
        <Border BorderBrush="Gray" BorderThickness="0,0,0,1">
            <Grid Margin="20">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Button Content="←"
                        FontSize="20"
                        Background="Transparent"
                        BorderThickness="0"
                        Click="BackPage_Click"/>

                <TextBlock Grid.Column="1"
                           Text="マスタ管理画面・詳細"
                           FontSize="20"
                           VerticalAlignment="Center"/>
            </Grid>
        </Border>

        <!-- ===== 本体 ===== -->
        <Grid Grid.Row="1" Margin="20,10,20,0">
            <Grid.RowDefinitions>
                <RowDefinition Height="0.9*"/>
                <RowDefinition Height="auto"/>
            </Grid.RowDefinitions>

            <!-- 品目＆項目マスタ（閲覧専用） -->
            <Grid Grid.Row="0" x:Name="ItemRegistration" Visibility="Collapsed">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="0.4*"/>
                    <ColumnDefinition Width="0.6*"/>
                </Grid.ColumnDefinitions>

                <!-- ===== 左：基本情報 ===== -->
                <StackPanel Grid.Column="0" VerticalAlignment="Top" Margin="0,0,10,0">
                    <TextBlock Text="基本情報" FontSize="20" FontWeight="Bold" Margin="0,0,0,20"/>

                    <TextBlock Text="品目名"/>
                    <TextBox x:Name="ItemNameBox" IsReadOnly="True" IsEnabled="False"/>

                    <TextBlock Text="品目コード" Margin="0,15,0,0"/>
                    <TextBox x:Name="ItemCodeBox" IsReadOnly="True" IsEnabled="False"/>

                    <TextBlock Text="区分" Margin="0,15,0,0"/>
                    <ComboBox x:Name="CategoryConboBox" DisplayMemberPath="Item_category_name" SelectedValuePath="Item_category_id" IsEnabled="False"/>

                    <TextBlock Text="数量単位" Margin="0,15,0,0"/>
                    <ComboBox x:Name="CountUnitComboBox" DisplayMemberPath="Code" SelectedValuePath="Id"
                  IsEnabled="False"/>

                    <TextBlock Text="重量単位" Margin="0,15,0,0"/>
                    <ComboBox x:Name="WightUnitComboBox" DisplayMemberPath="Code" SelectedValuePath="Id" IsEnabled="False"/>

                    <TextBlock Text="グレード" Margin="0,15,0,0"/>
                    <TextBox x:Name="GradeBox"
                  IsEnabled="False"/>

                    <TextBlock Text="比重" Margin="0,15,0,0"/>
                    <TextBox x:Name="SpecificGravityBox"
                 IsEnabled="False"/>

                    <TextBlock Text="荷姿" Margin="0,15,0,0"/>
                    <TextBox x:Name="PackingStyleBox"
                 IsEnabled="False"/>

                    <TextBlock Text="有効/無効" Margin="0,15,0,0"/>
                    <CheckBox x:Name="ItemEnabledCheckBox" Content="有効"
                                    IsEnabled="False"/>

                    <TextBlock Text="備考" Margin="0,15,0,0"/>
                    <TextBox TextWrapping="Wrap" IsEnabled="False"/>

                    <TextBlock Text="登録日時"
               FontWeight="Bold"
               FontSize="14"/>
                    <TextBlock x:Name="CreatedAtText"
               FontSize="13"
               />

                    <TextBlock Text="更新日時"
               FontWeight="Bold"
               FontSize="14"
               Margin="0,10,0,0"/>
                    <TextBlock x:Name="UpdatedAtText"
               FontSize="13"
               />
                </StackPanel>

                <!-- ===== 右：可変情報（閲覧専用） ===== -->
                <Grid Grid.Column="1">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0">
                        <TextBlock Text="入庫時に入力する可変情報"
                       FontSize="20"
                       FontWeight="Bold"/>

                        <TextBlock Text="Android入庫画面に表示するフィールドを設定"
                       FontSize="17"
                       Margin="0,0,0,15"/>

                        <!-- ListView（操作不可・表示のみ） -->
                        <ListView x:Name="listView"
                      ItemsSource="{Binding _ReceiptItem}"
                      SizeChanged="listView_SizeChanged"
                      ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                      Focusable="False">

                            <ListView.Resources>
                                <Style TargetType="{x:Type GridViewColumnHeader}">
                                    <Setter Property="Background" Value="LightGray"/>
                                    <Setter Property="FontWeight" Value="Bold"/>
                                </Style>
                            </ListView.Resources>

                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="フィールド名"
                                        DisplayMemberBinding="{Binding Name}" />

                                    <GridViewColumn Header="表示設定">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal">
                                                    <CheckBox IsChecked="{Binding 表示}" IsEnabled="{Binding DataContext.IsEditMode, RelativeSource={RelativeSource AncestorType=UserControl}}"/>
                                                    <TextBlock Text="表示する" FontSize="17" Margin="5,0,0,0" Foreground="{Binding DisplayTextColor}" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>

                                    <GridViewColumn Header="入力設定">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal"
                        HorizontalAlignment="Center"
                        Visibility="{Binding 表示, Converter={StaticResource BoolToVisibility}}">

                                                    <RadioButton Content="任意"
                             FontSize="17"
                             IsChecked="{Binding 任意}"
                             IsEnabled="{Binding DataContext.IsEditMode,
                                 RelativeSource={RelativeSource AncestorType=UserControl}}"/>

                                                    <RadioButton Content="必須"
                             Margin="20,0,0,0"
                             FontSize="17"
                             IsChecked="{Binding 必須}"
                             IsEnabled="{Binding DataContext.IsEditMode,
                                 RelativeSource={RelativeSource AncestorType=UserControl}}"/>
                                                </StackPanel>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>

                                </GridView>
                            </ListView.View>
                        </ListView>
                    </StackPanel>
                </Grid>
            </Grid>

            <Grid Grid.Row="0" x:Name="LocationRegistration" Visibility="Collapsed">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="0.4*"/>
                    <ColumnDefinition Width="0.6*"/>
                </Grid.ColumnDefinitions>
                <StackPanel Grid.Column="0">

                    <TextBlock Text="基本情報"
                       FontSize="20"
                       FontWeight="Bold"
                       Margin="0,0,0,30"/>

                    <!-- 保管場所名 -->
                    <TextBlock Text="保管場所名"/>
                    <TextBox x:Name="LocationNameBox"
                     Margin="0,5,0,20"
                     Height="30"
                    IsEnabled="False"
                     />

                    <!-- 保管場所コード -->
                    <TextBlock Text="保管場所コード"/>
                    <TextBox x:Name="LocationCodeBox"
                     Margin="0,5,0,20"
                     Height="30"
                    IsEnabled="False"
                     />

                    <!-- 有効/無効 -->
                    <TextBlock Text="有効/無効" Margin="0,20,0,0"/>
                    <CheckBox x:Name="LocationEnabledCheckBox" Content="有効" IsEnabled="False"/>

                    <!-- 備考 -->
                    <TextBlock Text="備考"/>
                    <TextBox x:Name="LocationRemarkBox"
                     Margin="0,5,0,0"
                     Height="100"
                     AcceptsReturn="True"
                     TextWrapping="Wrap"
                     IsEnabled="False"
                     />

                    <TextBlock Text="登録日時"
               FontWeight="Bold"
               FontSize="14"/>
                    <TextBlock x:Name="CreatedAtText2"
               FontSize="13"
               />

                    <TextBlock Text="更新日時"
               FontWeight="Bold"
               FontSize="14"
               Margin="0,10,0,0"/>
                    <TextBlock x:Name="UpdatedAtText2"
               FontSize="13"
               />
                </StackPanel>
            </Grid>

            <!-- 品目＆項目マスタ（閲覧専用） -->
            <Grid Grid.Row="0" x:Name="TagRegistration" Visibility="Visible">
                <TabControl Margin="0,0,0,15" Background="White" BorderThickness="0">
                    <!-- 基本情報タブ -->
                    <TabItem Header="基本情報">
                        <Grid Margin="0,15,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="0.4*"/>
                                <ColumnDefinition Width="0.6*"/>
                            </Grid.ColumnDefinitions>

                            <!-- ===== 左：基本情報 ===== -->
                            <StackPanel Grid.Column="0" VerticalAlignment="Top" Margin="0,0,20,0">
                                <TextBlock Text="アイテムコード(EPC)"/>
                                <TextBlock x:Name="TagEpcBox"/>

                                <!-- 有効/無効 -->
                                <TextBlock Text="有効/無効" Margin="0,20,0,0"/>
                                <CheckBox x:Name="TagEnabledCheckBox" Content="有効"
                                    IsEnabled="False"/>

                                <!-- ステータス -->
                                <TextBlock Text="ステータス" Margin="0,20,0,0"/>
                                <TextBlock x:Name="TagStatusBox" IsEnabled="False"/>

                                <!-- 備考 -->
                                <TextBlock Text="備考" Margin="0,20,0,0"/>
                                <TextBox x:Name="TagRemarkBox" AcceptsReturn="True"/>

                                <!-- 登録日時 -->
                                <TextBlock Text="登録日時" Margin="0,20,0,0"/>
                                <TextBlock x:Name="TagCreatedAtText"/>

                                <!-- 更新日時 -->
                                <TextBlock Text="更新日時" Margin="0,20,0,0"/>
                                <TextBlock x:Name="TagUpdatedAtText"/>
                            </StackPanel>
                        </Grid>
                    </TabItem>

                    <!-- 操作履歴タブ -->
                    <TabItem Header="操作履歴">
                        <Grid Margin="0,15,0,0">
                            <!-- リスト -->
                            <ListView x:Name="listView2" ItemsSource="{Binding TagHistoryList}" HorizontalAlignment="Stretch" ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                ScrollViewer.VerticalScrollBarVisibility="Auto"
                                SizeChanged="listView_SizeChanged2"
                                BorderThickness="0">
                                <ListView.Resources>
                                    <!-- 灰色のヘッダースタイル -->
                                    <Style x:Key="GrayHeaderStyle" TargetType="GridViewColumnHeader">
                                        <Setter Property="Background" Value="LightGray"/>
                                        <Setter Property="BorderThickness" Value="0"/>
                                    </Style>
                                </ListView.Resources>
                                <ListView.View>
                                    <GridView>
                                        <GridViewColumn Header="イベント日時" DisplayMemberBinding="{Binding EventDateTime}" HeaderContainerStyle="{StaticResource GrayHeaderStyle}"/>
                                        <GridViewColumn Header="イベント" DisplayMemberBinding="{Binding EventName}" HeaderContainerStyle="{StaticResource GrayHeaderStyle}" />
                                    </GridView>
                                </ListView.View>
                            </ListView>
                        </Grid>
                    </TabItem>
                </TabControl>
            </Grid>

            <Grid Grid.Row="1">
                <StackPanel 
                    Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Bottom"
                    Margin="0,0,0,0">
                    <!-- ===== 下部ボタン ===== -->
                    <Button x:Name="EditSaveButton" 
                        Content="編集"
                        Width="80"
                        Height="35"
                        Background="White"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Bottom"
                        Margin="0,0,30,10"
                            Style="{StaticResource PrimaryButtonStyle}"
                        Click="EditSaveButton_Click"/>
                    <Button x:Name="EditCancelButton" 
                        Content="キャンセル"
                        Width="100"
                        Height="35"
                        Background="White"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Bottom"
                        Margin="0,0,30,10"
                        Visibility="Collapsed"
                        IsEnabled="False"
                            Style="{StaticResource PrimaryButtonStyle}"
                        Click="Cancel_Click"
                        />
                </StackPanel>
            </Grid>
        </Grid>
    </Grid>
</UserControl>
